

**Docker** — это платформа для упаковки, доставки и запуска приложений в **контейнерах**.
**Контейнеры** — это как **лёгкие виртуальные машины**, но без лишнего веса. Они используют общую ОС-хост, но изолированы друг от друга.

**Зачем нужен Docker:**

- Чтобы разработчики могли запускать приложение в **одинаковой среде** везде (на ноутбуке, сервере, в CI/CD).
- Чтобы **упростить деплой** — приложение и его зависимости упакованы в образ.
- Чтобы **изолировать** сервисы друг от друга (например, БД, API и UI).

| №   | Команда                                     | Расшифровка                                                                                                    |
| --- | ------------------------------------------- | -------------------------------------------------------------------------------------------------------------- |
| 1   | `docker system info`                        | Показывает общую информацию о Docker: версию, количество контейнеров/образов, системные данные                 |
| 2   | `docker build -t my-app:1.0 .`              | Собирает образ из Dockerfile в текущей директории и тегирует его как `my-app:1.0`                              |
| 3   | `docker run -d --name web -p 8080:80 nginx` | Запускает контейнер в фоне из образа nginx с именем `web` и пробрасывает порт 8080 хоста на порт 80 контейнера |
| 4   | `docker ps`                                 | Показывает только запущенные контейнеры                                                                        |
| 5   | `docker ps -a`                              | Показывает все контейнеры (включая остановленные)                                                              |
| 6   | `docker images`                             | Выводит список всех локальных образов                                                                          |
| 7   | `docker stop web`                           | Останавливает контейнер с именем `web` (graceful shutdown)                                                     |
| 8   | `docker start web`                          | Запускает остановленный контейнер `web`                                                                        |
| 9   | `docker rm web`                             | Удаляет остановленный контейнер `web`                                                                          |
| 10  | `docker rmi nginx:latest`                   | Удаляет образ `nginx:latest` с локальной машины                                                                |
| 11  | `docker exec -it web bash`                  | Запускает интерактивную bash-сессию внутри запущенного контейнера `web`                                        |
| 12  | `docker logs web`                           | Показывает логи контейнера `web`                                                                               |
| 13  | `docker logs -f web`                        | Показывает логи в реальном времени (follow mode)                                                               |
| 14  | `docker pull redis:7.0`                     | Скачивает образ `redis:7.0` из реестра (Docker Hub) без запуска                                                |
| 15  | `docker inspect web`                        | Показывает детальную информацию о контейнере `web` в JSON-формате                                              |
| 16  | `docker network ls`                         | Показывает список всех Docker-сетей                                                                            |
| 17  | `docker volume ls`                          | Показывает список всех Docker-томов (volumes)                                                                  |
| 18  | `docker system prune`                       | Очищает систему: удаляет остановленные контейнеры, неиспользуемые сети и build cache                           |
| 19  | `docker-compose up -d`                      | Запускает многоконтейнерное приложение из docker-compose.yml в фоновом режиме                                  |
| 20  | `docker stats`                              | Показывает live-статистику по использованию ресурсов всеми контейнерами                                        |

## Команды Dockerfile

| Команда | Синтаксис | Описание | Пример |
|---------|-----------|-----------|---------|
| **FROM** | `FROM <image>:<tag>` | **Обязательная** первая команда. Указывает базовый образ | `FROM ubuntu:20.04` |
| **WORKDIR** | `WORKDIR <path>` | Устанавливает рабочую директорию для последующих команд | `WORKDIR /app` |
| **COPY** | `COPY <src> <dest>` | Копирует файлы/папки с хоста в образ | `COPY . .` |
| **ADD** | `ADD <src> <dest>` | Как COPY, но может распаковывать архивы и скачивать URL | `ADD file.tar.gz /tmp/` |
| **RUN** | `RUN <command>` | Выполняет команду во время сборки образа | `RUN apt-get update` |
| **CMD** | `CMD ["exec", "arg1"]` | Определяет команду по умолчанию при запуске контейнера | `CMD ["python", "app.py"]` |
| **ENTRYPOINT** | `ENTRYPOINT ["exec"]` | Определяет основную исполняемую команду контейнера | `ENTRYPOINT ["nginx"]` |
| **EXPOSE** | `EXPOSE <port>` | Документирует, какие порты прослушивает контейнер | `EXPOSE 80` |
| **ENV** | `ENV <key>=<value>` | Устанавливает переменные окружения | `ENV NODE_ENV=production` |
| **ARG** | `ARG <name>=<value>` | Определяет переменные для использования во время сборки | `ARG VERSION=1.0` |
| **VOLUME** | `VOLUME ["/path"]` | Создает точку монтирования для внешних томов | `VOLUME ["/data"]` |
| **USER** | `USER <user>` | Устанавливает пользователя для последующих команд | `USER nobody` |
| **LABEL** | `LABEL <key>=<value>` | Добавляет метаданные к образу | `LABEL version="1.0"` |
| **HEALTHCHECK** | `HEALTHCHECK [options] CMD` | Определяет команду для проверки здоровья контейнера | `HEALTHCHECK CMD curl http://localhost/` |
| **SHELL** | `SHELL ["exec"]` | Определяет shell для RUN, CMD, ENTRYPOINT | `SHELL ["/bin/bash", "-c"]` |
| **STOPSIGNAL** | `STOPSIGNAL <signal>` | Устанавливает сигнал для остановки контейнера | `STOPSIGNAL SIGTERM` |
| **ONBUILD** | `ONBUILD <instruction>` | Добавляет инструкцию для выполнения при использовании образа как базового | `ONBUILD COPY . .` |

## Ключевые отличия:

- **RUN** vs **CMD** vs **ENTRYPOINT**: RUN выполняется при сборке, CMD/ENTRYPOINT — при запуске контейнера
- **COPY** vs **ADD**: COPY для простого копирования, ADD с дополнительными функциями
- **ENV** vs **ARG**: ENV доступны в контейнере, ARG только при сборке
## Ключевые флаги, используемые в командах:

- `-d` (--detach) - запуск в фоновом режиме
- `-it` (--interactive + --tty) - интерактивный режим с псевдо-TTY
- `-p` (--publish) - проброс портов хост:контейнер
- `-v` (--volume) - подключение томов/директорий
- `--name` - указание имени контейнера
- `-f` (--follow) - следовать за выводом (логи)
- `-a` (--all) - показать все элементы

## Основные определения Docker

| Термин                | Определение                                                                                                                                  |
| --------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
| **Docker**            | Платформа для разработки, доставки и запуска приложений в контейнерах. Решает проблему "works on my machine" через стандартизацию окружения. |
| **Контейнер**         | Изолированный процесс в операционной системе, который включает приложение и все его зависимости. Запускается из образа.                      |
| **Образ (Image)**     | Шаблон только для чтения, используемый для создания контейнеров. Состоит из слоев и содержит файловую систему, код и зависимости приложения. |
| **Dockerfile**        | Текстовый файл с инструкциями для сборки Docker-образа. Содержит команды, которые выполняются последовательно.                               |
| **Docker Hub**        | Публичный реестр образов Docker (как GitHub для кода). Содержит официальные и пользовательские образы.                                       |
| **Docker Engine**     | Основной компонент Docker, который состоит из демона (dockerd), REST API и CLI. Отвечает за создание и запуск контейнеров.                   |
| **Docker Compose**    | Инструмент для определения и запуска многоконтейнерных приложений с помощью YAML-файла.                                                      |
| **Docker Swarm**      | Нативное решение Docker для оркестрации контейнеров (кластеризация и управление множеством контейнеров).                                     |
| **Том (Volume)**      | Механизм для сохранения данных, независимо от жизненного цикла контейнера. Обеспечивает постоянное хранение.                                 |
| **Bind Mount**        | Привязка конкретной директории или файла с хостовой машины в контейнер.                                                                      |
| **Docker Network**    | Виртуальная сеть для изолированного общения контейнеров между собой.                                                                         |
| **Слой (Layer)**      | Каждая инструкция в Dockerfile создает новый слой образа. Слои кэшируются и используются повторно.                                           |
| **Тег (Tag)**         | Метка, идентифицирующая версию или вариант образа (например: `nginx:1.20`, `myapp:latest`).                                                  |
| **Docker Registry**   | Хранилище для Docker-образов (может быть публичным как Docker Hub или приватным).                                                            |
| **Docker Daemon**     | Фоновый процесс (dockerd), который управляет контейнерами, образами, томами и сетями.                                                        |
| **Docker CLI**        | Командный интерфейс для взаимодействия с Docker Daemon через команды (`docker run`, `docker build` и т.д.).                                  |
| **Orchestration**     | Автоматическое развертывание, масштабирование и управление контейнерами (Kubernetes, Docker Swarm).                                          |
| **.dockerignore**     | Файл, аналогичный .gitignore, который указывает, какие файлы игнорировать при сборке образа.                                                 |
| **Multi-stage build** | Возможность использовать несколько образов в одном Dockerfile для оптимизации финального образа.                                             |
| **Containerization**  | Технология виртуализации на уровне ОС, которая позволяет запускать изолированные процессы, используя общее ядро хоста.                       |
| **Docker Compose**    | Инструмент для определения и запуска многоконтейнерных приложений Docker.                                                                    |

## Docker Networks (Сети)

### Основные команды

| Команда | Описание | Пример |
|---------|-----------|---------|
| **Создание сети** | Создает новую сеть | `docker network create my_network` |
| **Просмотр сетей** | Список всех сетей | `docker network ls` |
| **Информация о сети** | Детальная информация | `docker network inspect my_network` |
| **Подключение контейнера** | Добавить контейнер в сеть | `docker network connect my_network container1` |
| **Отключение контейнера** | Убрать контейнер из сети | `docker network disconnect my_network container1` |
| **Удаление сети** | Удалить сеть | `docker network rm my_network` |
| **Очистка сетей** | Удалить неиспользуемые сети | `docker network prune` |
### Типы сетей

| Тип сети | Команда | Использование |
|----------|---------|---------------|
| **Bridge** | `docker network create -d bridge my_bridge` | По умолчанию, для standalone контейнеров |
| **Host** | `docker run --network host nginx` | Использует сеть хоста, нет изоляции |
| **None** | `docker run --network none alpine` | Без сети, полная изоляция |
| **Overlay** | `docker network create -d overlay my_overlay` | Для Docker Swarm, несколько хостов |
## Docker Volumes (Тома)

### Основные команды

| Команда | Описание | Пример |
|---------|-----------|---------|
| **Создание тома** | Создает именованный том | `docker volume create my_volume` |
| **Просмотр томов** | Список всех томов | `docker volume ls` |
| **Информация о томе** | Детальная информация | `docker volume inspect my_volume` |
| **Удаление тома** | Удалить том | `docker volume rm my_volume` |
| **Очистка томов** | Удалить неиспользуемые тома | `docker volume prune` |
### Типы томов

| Тип тома | Синтаксис | Описание |
|----------|-----------|-----------|
| **Named Volume** | `-v volume_name:/path/in/container` | Управляется Docker, для production |
| **Bind Mount** | `-v /host/path:/container/path` | Связывает папку хоста и контейнера |
| **Anonymous Volume** | `-v /container/path` | Временный том, автоматическое имя |
| **tmpfs Mount** | `--tmpfs /container/path` | Только в RAM, данные не сохраняются |

## Полезные команды для отладки

| Задача | Команда |
|--------|---------|
| **Просмотр всех сетей и томов** | `docker system df` |
| **Информация о контейнере** | `docker inspect container_name` |
| **Проверка mounted volumes** | `docker inspect container_name \| grep -A 10 Mounts` |
| **Просмотр сетевых подключений** | `docker network inspect network_name \| grep Containers` |
| **Поиск больших томов** | `docker system df -v` |

##  Быстрые команды для запоминания

| Действие | Команда |
|----------|---------|
| **Создать и использовать сеть** | `docker network create my_net && docker run --network my_net nginx` |
| **Создать и использовать том** | `docker volume create my_vol && docker run -v my_vol:/data alpine` |
| **Быстрая разработка** | `docker run -v $(pwd):/app -p 3000:3000 node:16` |
| **Очистка всего** | `docker system prune -a --volumes` |
